import{r as l,j as a}from"./index-CeHBmUBv.js";function z(){const f=l.useRef(null),h=l.useRef(null),w=l.useRef(null),v=l.useRef(null),[R,C]=l.useState(null),[j,y]=l.useState(""),[b,N]=l.useState(!1),I=async n=>{const s=n.target.files[0];if(!s||!s.type.startsWith("image/")){y("Invalid file format");return}C(s),y("");const e=f.current,c=h.current,o=e.getContext("2d"),d=c.getContext("2d"),t=new Image;t.addEventListener("load",()=>{o.clearRect(0,0,e.width,e.height);const i=Math.min(e.width/t.width,e.height/t.height),m=(e.width-t.width*i)/2,r=(e.height-t.height*i)/2;o.clearRect(0,0,e.width,e.height),d.clearRect(0,0,c.width,c.height),o.drawImage(t,m,r,t.width*i,t.height*i),d.drawImage(t,m,r,t.width*i,t.height*i),URL.revokeObjectURL(t.src)}),t.src=URL.createObjectURL(s)},L=()=>{w.current.click()},U=()=>{if(!R)return;const n=h.current,s=n.getContext("2d",{willReadFrequently:!0}),e=new Image;e.addEventListener("load",()=>{s.clearRect(0,0,n.width,n.height);const c=Math.min(n.width/e.width,n.height/e.height),o=(n.width-e.width*c)/2,d=(n.height-e.height*c)/2;s.drawImage(e,o,d,e.width*c,e.height*c);const{width:t,height:i}=n,r=s.getImageData(0,0,t,i,{willReadFrequently:!0}).data,g=parseInt(v.current.value)||10;for(let u=0;u<i;u+=g)for(let x=0;x<t;x+=g){const p=(u*t+x)*4,S=r[p],D=r[p+1],E=r[p+2];s.fillStyle=`rgb(${S}, ${D}, ${E})`,s.fillRect(x,u,g,g)}N(!0)}),e.src=URL.createObjectURL(R)},k=()=>{const n=h.current,s=document.createElement("a");s.download="pixelated-image.jpg",s.href=n.toDataURL("image/jpg"),s.click()};return a.jsx("div",{children:a.jsxs("div",{className:"container",children:[a.jsxs("div",{className:"canvases",children:[a.jsxs("div",{className:"canvas",children:[a.jsx("canvas",{className:"source",ref:f,width:252,height:380}),a.jsx("input",{type:"file",accept:"image/",ref:w,style:{display:"none"},onChange:I}),a.jsx("button",{className:"button",onClick:L,children:"Upload"})]}),a.jsxs("div",{className:"canvas",children:[a.jsx("canvas",{className:"source",ref:h,width:252,height:380}),a.jsx("button",{className:"button",onClick:k,disabled:!b,children:"Download"})]})]}),j&&a.jsx("div",{style:{color:"red"},children:j}),a.jsxs("div",{className:"options",children:[a.jsx("input",{type:"range",className:"size",ref:v,min:10}),a.jsx("button",{className:"button",onClick:U,children:"Apply Filter"})]})]})})}export{z as default};
