import{r,j as s}from"./index-BZzQVltc.js";function X(){const f=r.useRef(null),[x,R]=r.useState(null),C=r.useRef(null),[u,b]=r.useState(null),[h,v]=r.useState(!1),[E,w]=r.useState(!1),[y,L]=r.useState(!1),[j,m]=r.useState(""),i=r.useRef(0),c=r.useRef(0),g=r.useRef(0),p=r.useRef(0),D=async d=>{const e=d.target.files[0];if(!e||!e.type.startsWith("image/")){m("Invalid file use  only images");return}R(e),m("");const o=f.current,l=o.getContext("2d"),n=new Image;n.addEventListener("load",()=>{l.clearRect(0,0,o.width,o.height);const t=Math.min(o.width/n.width,o.height/n.height),a=(o.width-n.width*t)/2,S=(o.height-n.height*t)/2;l.drawImage(n,a,S,n.width*t,n.height*t),L(!0),w(!1),URL.revokeObjectURL(x)}),n.src=URL.createObjectURL(e)};r.useEffect(()=>{(!x||!y)&&w(!0)},[x,y]);const I=()=>{C.current.click(),w(!0)};r.useEffect(()=>{let d=!1;const e=f.current;if(!e)return;const o=t=>{if(!h)return;const a=e.getBoundingClientRect();i.current=t.clientX-a.left,c.current=t.clientY-a.top,d=!0,console.log("sX coordinate:",i,"sY coordinate:",c)},l=t=>{if(!h||!d)return;const a=e.getBoundingClientRect();g.current=t.clientX-a.left,p.current=t.clientY-a.top,b({x:i.current,y:c.current,width:g.current-i.current,height:p.current-c.current}),console.log("eX coordinate:",g,"eY coordinate:",p)},n=()=>{if(!h)return;d=!1;const t=document.createElement("canvas");t.width=g.current-i.current,t.height=p.current-c.current,t.getContext("2d").drawImage(e,i.current,c.current,t.width,t.height,0,0,t.width,t.height),console.log("cropped canvas width :",t.width,"cropped canvas height:",t.height),v(!1)};return e.addEventListener("mousedown",o),e.addEventListener("mousemove",l),e.addEventListener("mouseup",n),()=>{e.removeEventListener("mousedown",o),e.removeEventListener("mousemove",l),e.removeEventListener("mouseup",n)}},[h]);const k=()=>{if(!h)v(!0);else{const d=f.current,e=document.createElement("canvas");e.width=g.current-i.current,e.height=p.current-c.current;const o=e.getContext("2d"),l=e.width,n=e.height;if(l<=0||n<=0){m("Invalid crop area. Try dragging again.");return}m(""),o.drawImage(d,i.current,c.current,e.width,e.height,0,0,e.width,e.height);const t=document.createElement("a");t.download="cropped-image.jpg",t.href=e.toDataURL("image/jpg"),t.click(),v(!1)}};return s.jsx("div",{children:s.jsxs("div",{className:"container",style:{backgroundColor:"#333333",borderRadius:"25px",padding:"10px",filter:"drop-shadow(0px 10px 15px rgba(20, 19, 19, 1))"},children:[s.jsx("div",{className:"description",style:{marginTop:"10px",fontSize:"18px",marginBottom:"10px"},children:"Drag and draw on the image to set a cropping area"}),j&&s.jsx("div",{style:{color:"red",fontWeight:"bold"},children:j}),s.jsxs("div",{style:{width:"600px",height:"600px"},children:[s.jsx("canvas",{width:600,height:600,ref:f}),u&&s.jsx("div",{style:{position:"absolute",top:u.y,left:u.x,width:u.width,height:u.height,border:"5px dashed red",pointerEvents:"none"}})]}),s.jsxs("div",{className:"options",style:{display:"flex",gap:"10px",justifyContent:"center"},children:[s.jsx("input",{type:"file",accept:"image/",ref:C,style:{display:"none"},onChange:D}),s.jsx("button",{style:{backgroundColor:"#243df8ff"},onClick:I,children:"Upload an Image"}),s.jsx("button",{style:{backgroundColor:"#243df8ff"},disabled:E,onClick:k,children:"Crop and Download"})]})]})})}export{X as default};
