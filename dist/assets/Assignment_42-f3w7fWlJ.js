import{r as s,j as n}from"./index-C9WPfzIw.js";const W=86.4,B=45.4,i={},G=3,te=.375,M=35,C=290,S=[{x:66.8,y:16,w:52,h:92},{x:188.8,y:16,w:48,h:94.8},{x:7,y:192.2,w:52.6,h:136.4},{x:425.2,y:19.8,w:60.1,h:137.3}];let re=0;const se=2,ne=.2,I=3;function ae(){const j=s.useRef(0),[P,Y]=s.useState(0),f=s.useRef(null),y=s.useRef(null),[_,k]=s.useState(null),o=s.useRef([]),l=s.useRef(360),[A,L]=s.useState(!1),[U,X]=s.useState(0),[a,D]=s.useState("start");s.useEffect(()=>{let t=null,E=performance.now(),p=f.current;if(!p||!y.current)return;let J=y.current.offsetWidth,h=p.offsetWidth,c=(J-h)/2;p.style.left=c+"px";let T=0,K=1e3;window.onkeydown=r=>{a==="playing"&&((r.key==="ArrowLeft"||r.key==="ArrowRight")&&r.preventDefault(),i[r.key]=!0)},window.onkeyup=r=>{a==="playing"&&((r.key==="ArrowLeft"||r.key==="ArrowRight")&&r.preventDefault(),i[r.key]=!1)};const O=r=>{t=requestAnimationFrame(O);const F=r-E;if(j.current+=te*F,E=r,a==="playing"&&(A||(i.ArrowLeft?(c=Math.max(M+h/2,c-G),k("left")):i.ArrowRight?(c=Math.min(C-h/2,c+G),k("right")):k("idle")),o.current.length<se&&r-T>K)){const e=Math.floor(Math.random()*S.length),d=(C-M)/I,u=Array.from({length:I},(x,w)=>M+w*d+d/2),m=u[Math.floor(Math.random()*u.length)]-S[e].w/2,v=Math.max(M,Math.min(m,C-S[e].w));o.current.every(x=>{const w=Math.abs(x.x-m)<5,R=Math.abs(x.y- -120);return!(w&&R)})&&o.current.push({id:++re,sprite:S[e],x:v,y:-120,nearMissAwarded:!1}),T=r}o.current.forEach(e=>{e.y+=ne*F}),o.current=o.current.filter(e=>e.y<480),o.current.forEach(e=>{const d=e.sprite.w,u=e.sprite.h,b=e.x+d/2,m=e.y+u/2,v=c-h/2,N=c+h/2,x=l.current-W/2,w=l.current+W/2,R=b-d/2,H=b+d/2,Q=m-u/2,V=m+u/2,$=v<H&&N>R&&x<V&&w>Q;$&&!A&&(console.log("Collision detected"),L(!0),D("gameOver"),window.onkeydown=g=>{i[g.key]=!1},window.onkeyup=g=>{i[g.key]=!1});const q=10,Z=Math.abs(N-R)<q||Math.abs(H-v)<q,ee=!$&&Z;e.y>0&&ee&&!e.nearMissAwarded&&(e.nearMissAwarded=!0,X(g=>g+1))}),p.style.left=c+"px",p.style.top=l.current+"px",Y(e=>e+1)};return t=requestAnimationFrame(O),()=>{cancelAnimationFrame(t)}},[a,A]);const z=()=>{if(D("playing"),L(!1),X(0),o.current=[],j.current=0,l.current=360,k("idle"),Object.keys(i).forEach(t=>{i[t]=!1}),f.current&&y.current){const t=y.current.offsetWidth;f.current.style.left=(t-B)/2+"px",f.current.style.top=l.current+"px"}};return n.jsx("div",{children:n.jsxs("div",{ref:y,className:"container","data-counter":P,style:{backgroundPosition:`center ${j.current}px`},children:[n.jsx("div",{className:"cars",children:o.current.map(t=>n.jsx("div",{className:"car",style:{width:t.sprite.w,height:t.sprite.h,top:t.y,left:t.x,backgroundPosition:`-${t.sprite.x}px -${t.sprite.y}px`}},t.id))}),n.jsx("div",{className:"player","data-direction":_,ref:f,style:{width:B,height:W,top:l.current+"px",visibility:a==="playing"?"visible":"hidden"}}),n.jsxs("div",{className:"score",children:["Score: ",U]}),a!=="playing"&&n.jsx("div",{className:"overlay",children:n.jsxs("div",{className:"overlay-box",children:[n.jsx("div",{className:"overlay-title",children:a==="gameOver"?"Game Over":"Highway Rush"}),n.jsx("div",{className:"overlay-description",children:a==="gameOver"?"Click Restart to try again":"Use arrow keys <= or =>, to score commit near misses"}),n.jsx("button",{className:"overlay-button",onClick:z,children:a==="start"?"Start":"Restart"})]})})]})})}export{ae as default};
