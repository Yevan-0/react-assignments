import{r as s,j as c}from"./index-CAgxcX6x.js";const M=86.4,G=45.4,i={},b=2,J=.375,w=35,L=290,m=[{x:66.8,y:16,w:52,h:92},{x:188.8,y:16,w:48,h:94.8},{x:7,y:192.2,w:52.6,h:136.4},{x:425.2,y:19.8,w:60.1,h:137.3}];let K=0;const O=2,F=.2,$=3;function V(){const j=s.useRef(0),[q,B]=s.useState(0),D=s.useRef(null),S=s.useRef(null),[H,x]=s.useState(null),n=s.useRef([]),h=s.useRef(360),[W,I]=s.useState(!1);return s.useEffect(()=>{let r=null,T=performance.now(),g=D.current,P=S.current.offsetWidth,l=g.offsetWidth,a=(P-l)/2;g.style.left=a+"px";let X=0,Y=300;window.onkeydown=t=>{(t.key==="ArrowLeft"||t.key==="ArrowRight")&&t.preventDefault(),i[t.key]=!0},window.onkeyup=t=>{(t.key==="ArrowLeft"||t.key==="ArrowRight")&&t.preventDefault(),i[t.key]=!1};const C=t=>{r=requestAnimationFrame(C);const k=t-T;if(j.current+=J*k,T=t,W||(i.ArrowLeft?(a=Math.max(w+l/2,a-b),x("left")):i.ArrowRight?(a=Math.min(L-l/2,a+b),x("right")):x("idle")),n.current.length<O&&t-X>Y){const e=Math.floor(Math.random()*m.length),f=(L-w)/$,u=Array.from({length:$},(d,p)=>w+p*f+f/2),y=u[Math.floor(Math.random()*u.length)]-m[e].w/2,R=Math.max(w,Math.min(y,L-m[e].w));n.current.every(d=>{const p=Math.abs(d.x-y)<5,A=Math.abs(d.y- -120);return!(p&&A)})&&n.current.push({id:++K,sprite:m[e],x:R,y:-120}),X=t}n.current.forEach(e=>{e.y+=F*k}),n.current=n.current.filter(e=>e.y<480),n.current.forEach(e=>{const f=e.x,u=e.y,E=e.sprite.w,y=e.sprite.h,R=a-l/2,N=a+l/2,d=h.current-M/2,p=h.current+M/2,A=f,_=f+E,v=u,z=u+y;R<_&&N>A&&d<z&&p>v&&!W&&(console.log("Collision detected"),I(!0),h.current+=F*k,window.onkeydown=o=>{(o.key==="ArrowLeft"||o.key==="ArrowRight")&&o.preventDefault(),i[o.key]=!1},window.onkeyup=o=>{(o.key==="ArrowLeft"||o.key==="ArrowRight")&&o.preventDefault(),i[o.key]=!1})}),g.style.left=a+"px",B(e=>e+1)};return r=requestAnimationFrame(C),()=>{cancelAnimationFrame(r)}},[]),c.jsx("div",{children:c.jsxs("div",{ref:S,className:"container","data-counter":q,style:{backgroundPosition:`center ${j.current}px`},children:[c.jsx("div",{className:"cars",children:n.current.map(r=>c.jsx("div",{className:"car",style:{width:r.sprite.w,height:r.sprite.h,top:r.y,left:r.x,backgroundPosition:`-${r.sprite.x}px -${r.sprite.y}px`}},r.id))}),c.jsx("div",{className:"player","data-direction":H,ref:D,style:{width:G,height:M,top:h.current+"px"}}),c.jsx("div",{className:"score"})]})})}export{V as default};
