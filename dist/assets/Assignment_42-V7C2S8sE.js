import{r as s,j as a}from"./index-BpsDKqAF.js";const C=88,q=46,h={},D=2,I=.375,y=20,k=260,x=[{x:66.8,y:16,w:46,h:100},{x:188.8,y:16,w:46,h:100},{x:7,y:192.2,w:50,h:151},{x:425.2,y:19.8,w:60,h:151}];let _=0;const z=2,T=.2,b=2;function J(){const A=s.useRef(0),[F,H]=s.useState(0),M=s.useRef(null),j=s.useRef(null),[P,m]=s.useState(null),r=s.useRef([]),S=s.useRef(360),[B,W]=s.useState(!1);return s.useEffect(()=>{let n=null,X=performance.now(),w=M.current,Y=j.current.offsetWidth,u=w.offsetWidth,o=(Y-u)/2;w.style.left=o+"px";let E=0,$=300;window.onkeydown=e=>{(e.key==="ArrowLeft"||e.key==="ArrowRight")&&e.preventDefault(),h[e.key]=!0},window.onkeyup=e=>{(e.key==="ArrowLeft"||e.key==="ArrowRight")&&e.preventDefault(),h[e.key]=!1};const L=e=>{W(!0),n=requestAnimationFrame(L);const g=e-X;if(A.current+=I*g,X=e,h.ArrowLeft?(o=Math.max(y+u/2,o-D),m("left")):h.ArrowRight?(o=Math.min(k-u/2,o+D),m("right")):m("idle"),r.current.length<z&&e-E>$){const t=Math.floor(Math.random()*x.length),c=(k-y)/b,i=Array.from({length:b},(l,f)=>y+f*c+c/2),p=i[Math.floor(Math.random()*i.length)]-x[t].w/2,d=Math.max(y,Math.min(p,k-x[t].w));r.current.every(l=>{const f=Math.min(l.x-p)<5,v=Math.abs(l.y- -120);return!(f&&v)})&&r.current.push({id:++_,sprite:x[t],x:d,y:-120}),E=e}r.current.forEach(t=>{t.y+=T*g}),r.current=r.current.filter(t=>t.y<480),r.current.forEach(t=>{const c=t.x,i=t.y,N=t.sprite.w,p=t.sprite.h,d=o,R=360,l=u,f=C;d<c+N&&d+l>c&&R<i+p&&R+f>i&&(console.log("Collision detected"),W(!1),S.current+=T*g)}),w.style.left=o+"px",H(t=>t+1)};return n=requestAnimationFrame(L),()=>{cancelAnimationFrame(n)}},[]),a.jsx("div",{children:a.jsxs("div",{ref:j,className:"container","data-counter":F,style:{backgroundPosition:`center ${A.current}px`},children:[a.jsx("div",{className:"cars",children:r.current.map(n=>a.jsx("div",{className:"car",style:{width:n.sprite.w,height:n.sprite.h,top:n.y,left:n.x,backgroundPosition:`-${n.sprite.x}px -${n.sprite.y}px`}},n.id))}),a.jsx("div",{className:"player","data-direction":P,ref:M,style:{width:q,height:C,top:S.current+"px"}}),a.jsx("div",{className:"score"})]})})}export{J as default};
